{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>All Songs</title>
    <link rel="stylesheet" href="{% static 'style_song.css' %}">
</head>
<body>
    <div class="header">
        <img src="{% static 'images/logo.png' %}" alt="Your Logo">
        <a href="{% url 'music:index' %}">Home</a>
        <a href="{% url 'music:add_song' %}">Add Song</a>
        <a href="{% url 'music:get_lyrics' %}">Get Lyrics</a>
    </div>

    <h1>All Songs</h1>

    <form method="get" action="{% url 'music:song_list' %}" id="search-form">
    <input type="text" id="search-input" placeholder="Search by title or artist">
</form>

<ul id="song-list">
    {% for song in songs %}
        <li>
            <img src="{{ song.image.url }}" alt="{{ song.title }}" width="50">
            <a href="{% url 'music:index' %}?song_id={{ song.id }}">
                {{ song.title }} - {{ song.artist }}
            </a>
        </li>
    {% empty %}
        <li>No songs available.</li>
    {% endfor %}
</ul>

<script>
document.getElementById('search-input').addEventListener('input', function () {
    let query = this.value;
    fetch(`/search-songs/?q=${encodeURIComponent(query)}`)
        .then(response => response.json())
        .then(data => {
            let songList = document.getElementById('song-list');
            songList.innerHTML = '';

            if (data.songs.length === 0) {
                songList.innerHTML = '<li>No songs found.</li>';
                return;
            }

            data.songs.forEach(song => {
                let li = document.createElement('li');
                li.innerHTML = `
                    <img src="${song.image}" alt="${song.title}" width="50">
                    <a href="/?song_id=${song.id}">
                        ${song.title} - ${song.artist}
                    </a>
                `;
                songList.appendChild(li);
            });
        });
});
</script>
</body>
</html>
